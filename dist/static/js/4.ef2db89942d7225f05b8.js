webpackJsonp([4],{D4d3:function(e,t){},wUZA:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=s("mvHQ"),i=s.n(o),r=s("pFYg"),n=s.n(r),a=s("P9l9"),l=s("MS2J"),c={data:function(){var e=this,t=function(t,s,o){l.c(s)?o(new Error("请输入密码")):s.length>=6&&s.length<=18?(!0!==e.signUpDialogVisible&&e.changePwdForm.newPassword===e.changePwdForm.oldPassword&&o(new Error("新旧密码不能相同")),o()):o(new Error("密码为6-18位字符串"))};return{updatePasswordVisible:!1,companyTypeOptions:[],signInForm:{email:"",password:""},changePwdForm:{oldPassword:"",newPassword:"",repeatPassword:""},changePwdFormRules:{oldPassword:[{required:!0,validator:t,trigger:"blur"}],newPassword:[{required:!0,validator:t,trigger:"blur"}],repeatPassword:[{required:!0,validator:function(t,s,o){e.changePwdForm.newPassword===s?o():o(new Error("两次输入的密码不相同"))},trigger:"blur"}]},signInRules:{email:[{required:!0,message:"请输入邮箱",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,max:16,message:"长度在 6 到 18 个字符",trigger:"blur"}]},cityDialogVisible:!1,isLogin:!1,index:!1,add:!1,del:!1,update:!1,query:!1}},computed:{signInDialogVisible:{get:function(){return this.$store.state.signInDialogVisible},set:function(e){!0===e?this.$store.commit("signInDialogVisibleTrue"):this.$store.commit("signInDialogVisibleFalse")}},user:{get:function(){return this.$store.state.user},set:function(){}},unReadNum:{get:function(){return this.$store.state.unReadNum},set:function(){}}},methods:{toEditPage:function(){var e=this.$route.path;console.log(e),"/blogPage"===e?this.$router.push({path:"/editBlogPage"}):"/meetingPage"===e&&this.$router.push({path:"/editMeetingPage"})},changePWD:function(){var e=this;Object(a.k)(this.changePwdForm).then(function(t){200===t.code?(e.$message.success("密码修改成功,请重新登录"),e.signOut()):2===t.code?(e.$store.commit("signInDialogVisibleTrue"),e.$router.push({path:"/meetingPage",query:{isError:!0}})):e.$message.error(t.msg)})},isEmpty:function(e){switch(void 0===e?"undefined":n()(e)){case"undefined":return!0;case"string":if(0===e.replace(/(^[ \t\n\r]*)|([ \t\n\r]*$)/g,"").length)return!0;break;case"boolean":if(!e)return!0;break;case"number":if(0===e||isNaN(e))return!0;break;case"object":if(null===e||0===e.length)return!0;for(var t in e)return!1;return!0}return!1},contains:function(e,t){return this.isEmpty(e)?(console.log("为空"),!1):-1!=e.indexOf(t)},signInDialogOpen:function(){var e=this.$route.path;"/blogPage"!==e&&"/bbsPage"!==e&&"/meetingPage"!==e?(console.log("执行具体逻辑"),this.$router.push({path:"/meetingPage"})):console.log("执行普通逻辑")},sendCode:function(){var e=this,t="";t="person"===this.labelPosition?this.signUpFormPerson.email:this.signUpFormCompany.email,console.log("发送邮件 "+t),l.c(t)||l.a(t,"email")&&Object(a.m)(t).then(function(s){!0!==s.data&&Object(a.t)(t).then(function(t){200===t.code?e.$message.success("验证码已发送,请查收！"):e.$message.error(t.msg)})})},handleSelect:function(e,t){},signIn:function(){var e=this,t={email:this.signInForm.email,password:this.signInForm.password};Object(a.A)(t).then(function(t){200===t.code?e.loginSucceed(t):(e.$message.error({message:t.msg}),e.isLogin=!1)}).catch(function(t){console.log(t),e.$message.error("登录失败，网络异常,请重试")})},signOut:function(){var e=this;console.log("调用退出登录");this.signInForm.phone,this.signInForm.password;Object(a.B)().then(function(t){e.isLogin=!1,200===t.code?(e.$message.success("退出登录成功"),sessionStorage.clear(),localStorage.clear(),e.index=!1,e.$router.push({path:"/meetingPage"})):(e.$message.error({message:t.msg}),e.isLogin=!1)}).catch(function(t){console.log(t),e.$message.error("退出登录失败，网络异常,请重试")})},loginSucceed:function(e){this.$store.commit("setHeadImg",{name:"stark",user:e.data.u}),sessionStorage.setItem("token",e.data.t),sessionStorage.setItem("user",i()(e.data.u)),localStorage.setItem("token",e.data.t),localStorage.setItem("user",i()(e.data.u)),localStorage.setItem("module",i()(e.data.m)),localStorage.setItem("permission",i()(e.data.p)),console.log("比较结果 "+this.contains(JSON.parse(localStorage.getItem("module")),"5d429e79bb9fe01c646d1fd6")),this.index=this.contains(JSON.parse(localStorage.getItem("module")),"5d429e79bb9fe01c646d1fd6"),this.signInDialogVisible=!1,this.isLogin=!0}},created:function(){l.c(localStorage.getItem("token"))?console.log("还未登录 "):(console.log("已经登录 "),this.isLogin=!0,this.index=this.contains(JSON.parse(localStorage.getItem("module")),"5d429e79bb9fe01c646d1fd6"),this.$store.commit("setHeadImg",{name:"stark",user:JSON.parse(localStorage.getItem("user"))}))},mounted:function(){this.$route.query.isError&&this.$message.error("权限错误，请重新登录"),this.isEmpty(this.user)}},d={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("section",{staticStyle:{height:"100%",display:"flex","justify-content":"center",width:"100%"}},[s("el-container",{directives:[{name:"loading",rawName:"v-loading.fullscreen.lock",value:this.$store.state.fullScreenLoading,expression:"this.$store.state.fullScreenLoading",modifiers:{fullscreen:!0,lock:!0}}],staticClass:"el-container main-page",staticStyle:{"background-color":"#ffffff"}},[s("el-header",{staticStyle:{position:"relative","background-color":"#545c64",padding:"0 1rem"}},[s("div",{staticClass:"home-log",staticStyle:{"background-color":"#545c64",color:"#fff","box-sizing":"border-box"}},[s("img",{staticStyle:{width:"133px",height:"35px"},attrs:{src:"/static/img/logo.png"}})]),e._v(" "),s("el-menu",{staticClass:"el-menu-demo",attrs:{"default-active":this.$route.path,mode:"horizontal",router:"","background-color":"#545c64","text-color":"#fff","active-text-color":"#409EFF"},on:{select:e.handleSelect}},[s("el-menu-item",{key:"3",attrs:{index:"/meetingPage"}},[e._v("时事新闻")]),e._v(" "),s("el-menu-item",{key:"1",attrs:{index:"/blogPage"}},[e._v("博客")]),e._v(" "),s("el-menu-item",{key:"2",attrs:{index:"/bbsPage"}},[e._v("论坛")]),e._v(" "),e.index?s("el-menu-item",{key:"4",attrs:{index:"/accountManager"}},[e._v("系统管理")]):e._e()],1),e._v(" "),s("div",{staticClass:"main-signIn"},[s("img",{staticClass:"editIcon",attrs:{src:"/static/img/icon/edit.png"},on:{click:e.toEditPage}}),e._v(" "),s("el-button",{directives:[{name:"show",rawName:"v-show",value:!e.isLogin,expression:"!isLogin"}],staticStyle:{color:"#fff"},attrs:{type:"text"},on:{click:function(t){e.signInDialogVisible=!0}}},[e._v("登录\n        ")]),e._v(" "),s("el-dropdown",{directives:[{name:"show",rawName:"v-show",value:e.isLogin,expression:"isLogin"}]},[s("div",{staticStyle:{display:"flex","justify-content":"flex-end","align-items":"center"}},[s("span",{staticStyle:{color:"#fff","margin-right":"10px"}},[e._v("\n                "+e._s(this.user.name)),s("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),e._v(" "),s("img",{directives:[{name:"show",rawName:"v-show",value:e.isEmpty(e.user.headImg),expression:"isEmpty(user.headImg)"}],staticStyle:{width:"45px",height:"45px"},attrs:{src:"https://justdj-umbrella.oss-cn-hangzhou.aliyuncs.com/default_header_img.png"}}),e._v(" "),s("img",{directives:[{name:"show",rawName:"v-show",value:!e.isEmpty(e.user.headImg),expression:"!isEmpty(user.headImg)"}],staticStyle:{width:"45px",height:"45px","border-radius":"50%"},attrs:{src:e.user.headImg}})]),e._v(" "),s("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[s("router-link",{attrs:{to:"/personCenter"}},[s("el-dropdown-item",{staticStyle:{"text-align":"center"},on:{click:function(e){return this.$router.push({path:"/personCenter"})}}},[e._v("个人中心\n              ")])],1),e._v(" "),s("el-dropdown-item",{nativeOn:{click:function(t){e.updatePasswordVisible=!0}}},[e._v("修改密码")]),e._v(" "),s("el-dropdown-item",{nativeOn:{click:function(t){return e.signOut(t)}}},[e._v("退出登录")])],1)],1)],1)],1),e._v(" "),s("keep-alive",[e.$route.meta.keepAlive?s("router-view"):e._e()],1),e._v(" "),e.$route.meta.keepAlive?e._e():s("router-view"),e._v(" "),s("el-dialog",{attrs:{title:"修改密码",visible:e.updatePasswordVisible,center:"",width:"31%","close-on-click-modal":!1},on:{"update:visible":function(t){e.updatePasswordVisible=t}}},[s("el-form",{attrs:{model:e.changePwdForm,rules:e.changePwdFormRules,"label-width":"6.25rem","label-position":"left"}},[s("el-form-item",{attrs:{label:"原密码",prop:"oldPassword"}},[s("el-input",{attrs:{type:"password",autocomplete:"off",placeholder:"请输入原密码"},model:{value:e.changePwdForm.oldPassword,callback:function(t){e.$set(e.changePwdForm,"oldPassword",t)},expression:"changePwdForm.oldPassword"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"新密码",prop:"newPassword"}},[s("el-input",{attrs:{type:"password",autocomplete:"off",placeholder:"请输入新密码"},model:{value:e.changePwdForm.newPassword,callback:function(t){e.$set(e.changePwdForm,"newPassword",t)},expression:"changePwdForm.newPassword"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"重复密码",prop:"repeatPassword"}},[s("el-input",{attrs:{type:"password",autocomplete:"off",placeholder:"请重复密码"},model:{value:e.changePwdForm.repeatPassword,callback:function(t){e.$set(e.changePwdForm,"repeatPassword",t)},expression:"changePwdForm.repeatPassword"}})],1)],1),e._v(" "),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer",center:"true"},slot:"footer"},[s("el-button",{on:{click:function(t){e.updatePasswordVisible=!1}}},[e._v("取 消")]),e._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:e.changePWD}},[e._v("确 定")])],1)],1),e._v(" "),s("el-dialog",{attrs:{title:"登录",modal:!1,visible:e.signInDialogVisible,center:"",width:"31%","close-on-click-modal":!1},on:{"update:visible":function(t){e.signInDialogVisible=t},open:e.signInDialogOpen}},[s("el-form",{attrs:{model:e.signInForm,rules:e.signInRules,"label-width":"6.25rem","label-position":"left"}},[s("el-form-item",{attrs:{label:"邮箱",prop:"email"}},[s("el-input",{attrs:{autocomplete:"off",placeholder:"请输入邮箱"},model:{value:e.signInForm.email,callback:function(t){e.$set(e.signInForm,"email",t)},expression:"signInForm.email"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"密码",prop:"password"}},[s("el-input",{attrs:{type:"password",autocomplete:"off",placeholder:"请输入密码"},model:{value:e.signInForm.password,callback:function(t){e.$set(e.signInForm,"password",t)},expression:"signInForm.password"}})],1)],1),e._v(" "),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer",center:"true"},slot:"footer"},[s("el-button",{on:{click:function(t){e.signInDialogVisible=!1}}},[e._v("取 消")]),e._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:e.signIn}},[e._v("确 定")])],1)],1)],1)],1)},staticRenderFns:[]};var g=s("VU/8")(c,d,!1,function(e){s("D4d3")},"data-v-c293fa7c",null);t.default=g.exports}});